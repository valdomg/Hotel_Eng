<!DOCTYPE html>
<html lang="pt-BR">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Página do Usuário</title>
    <!-- Importação do Bootstrap para estilização -->
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet">
    
    <!-- Importação da fonte Open Sans do Google Fonts -->
    <link href="https://fonts.googleapis.com/css2?family=Open+Sans:wght@300..800&display=swap" rel="stylesheet">

    <!-- Importação do arquivo de estilos CSS personalizado -->
    <link rel="stylesheet" href="{{ url_for('static', filename='css/styles.css') }}">
</head>
<body>

    <!-- NAVBAR (Barra de Navegação) -->
    <header>
        <div class="navbar">
          <div class="navbar-col logo">
            <!-- Link para a página inicial com a logo -->
            <a href="{{ url_for('home' ) }}">
              <img class="img-logo-nav" src="{{ url_for('static', filename='imagens/logo/logo.png' ) }}" alt="Logo">
            </a>
          </div> 
  
          <!-- Campo de pesquisa na navbar -->
          <div class="navbar-col pesquisa">
            <input type="text" class="form-control pesquisa" placeholder="Pesquisar ⌕">
          </div>
  
          <!-- Link para a página "Quem Somos" -->
          <div class="navbar-col quem-somos">
            <a href="{{ url_for('quemSomos' ) }}"> Quem Somos </a>
          </div>

          <div class="navbar-col">
            <a href="{{ url_for('carrinho' ) }}">Carrinho</a>
          </div>
  
          <!-- Link para a página de login -->
          <div class="navbar-col login">
  
            {% if session['loggedin'] == True %}
              <a href="{{ url_for('usuario', id=session['id']) }}"> Olá, {{session['username']}}</a>
            {% elif session['loggedin'] == False %}
              <a href="{{ url_for('login' ) }}">Login</a>
            {% else %}
              <a href="{{ url_for('login' ) }}">Login</a>
            {% endif %}
            
          </div>
        </div>
      </header>
      
      {% if session['loggedin'] == True %}
      <main>
        <section>
          <div class="carrinho-container">
            {% for hotelCarrinho in hotelCarrinho %}
            <div class="card-carrinho">
                <img src="{{ url_for('static', filename=hotelCarrinho.hotel_img_home ) }}" alt="Imagem do Hotel">
                <div class="info">
                    <h3>{{ hotelCarrinho.nome }}</h3>
                    <p>{{ hotelCarrinho.localizacao }}</p>
                    <p class="preco-diaria">R$ {{ hotelCarrinho.preco_diaria }}</p>
                  <h4 class="preco-total-valor">Total: R$ 0,00</h4>
                    <p class="quantidade">Quantidade: {{ hotelCarrinho.quantidade }}</p>
                    <form action="/remover_do_carrinho" method="POST">
                        <input type="hidden" name="id_hotel" value="{{ hotelCarrinho.id }}">
                        <button type="submit" class="remover">Remover</button>
                    </form>
                </div>
            </div>
            {% endfor %}
          </div>
        </section>
      </main>

      {% else %}
        <img class="goku-careca" src="{{ url_for('static' , filename='imagens/teste/goku-careca.png' ) }}" alt="">
      {% endif %}

    </div>
    
    <script>
    function carregarCarrinho() {
        fetch("/carrinho")
        .then(response => response.json())
        .then(itens => {
            let lista = document.getElementById("lista-carrinho");
            lista.innerHTML = "";
            itens.forEach(item => {
                lista.innerHTML += `<li>${item[1]} - ${item[2]} | ${item[3]} diárias - R$ ${item[4]}
                    <button onclick="removerItem(${item[0]})">Remover</button></li>`;
            });
        });
    }
    
    function removerItem(id) {
        fetch(`/remover_carrinho/${id}`, { method: "DELETE" })
        .then(response => response.json())
        .then(() => carregarCarrinho());
    }
    
    carregarCarrinho();
    </script>
      <footer>

      </footer>
</body>
</html>
